2025-10-15 05:55:56,329 - nanochat.checkpoint_manager - [32m[1mINFO[0m - No model tag provided, guessing model tag: d20
2025-10-15 05:55:56,329 - nanochat.checkpoint_manager - [32m[1mINFO[0m - Loading model from /root/.cache/nanochat/base_checkpoints/d20 with step 21400
2025-10-15 05:55:57,506 - nanochat.checkpoint_manager - [32m[1mINFO[0m - Building model with config: {'sequence_len': 2048, 'vocab_size': 65536, 'n_layer': 20, 'n_head': 10, 'n_kv_head': 10, 'n_embd': 1280}
Tokens / micro-batch / rank: 32 x 2048 = 65,536
Tokens / micro-batch: 524,288
Total batch size 524,288 => gradient accumulation steps: 1
Scaling the LR for the AdamW parameters ‚àù1/‚àö(1280/768) = 0.774597
Muon: Grouping 80 params of shape torch.Size([1280, 1280]), device cuda:0, dtype torch.float32
Muon: Grouping 20 params of shape torch.Size([1280, 5120]), device cuda:0, dtype torch.float32
Muon: Grouping 20 params of shape torch.Size([5120, 1280]), device cuda:0, dtype torch.float32
Traceback (most recent call last):
  File "/usr/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/sgl-workspace/nanochat/scripts/mid_train.py", line 93, in <module>
    MMLU(subset="auxiliary_train", split="train"), # 100K rows of multiple choice problems drawn from ARC, MC_TEST, OBQA, RACE
  File "/sgl-workspace/nanochat/tasks/mmlu.py", line 22, in __init__
    self.ds = load_dataset("cais/mmlu", subset, split=split).shuffle(seed=42)
  File "/sgl-workspace/nanochat/.venv/lib/python3.10/site-packages/datasets/load.py", line 1412, in load_dataset
    builder_instance.download_and_prepare(
  File "/sgl-workspace/nanochat/.venv/lib/python3.10/site-packages/datasets/builder.py", line 845, in download_and_prepare
    raise OSError(
OSError: Not enough disk space. Needed: Unknown size (download: 45.32 MiB, generated: 153.54 MiB, post-processed: Unknown size)
[rank0]: Traceback (most recent call last):
[rank0]:   File "/usr/lib/python3.10/runpy.py", line 196, in _run_module_as_main
[rank0]:     return _run_code(code, main_globals, None,
[rank0]:   File "/usr/lib/python3.10/runpy.py", line 86, in _run_code
[rank0]:     exec(code, run_globals)
[rank0]:   File "/sgl-workspace/nanochat/scripts/mid_train.py", line 93, in <module>
[rank0]:     MMLU(subset="auxiliary_train", split="train"), # 100K rows of multiple choice problems drawn from ARC, MC_TEST, OBQA, RACE
[rank0]:   File "/sgl-workspace/nanochat/tasks/mmlu.py", line 22, in __init__
[rank0]:     self.ds = load_dataset("cais/mmlu", subset, split=split).shuffle(seed=42)
[rank0]:   File "/sgl-workspace/nanochat/.venv/lib/python3.10/site-packages/datasets/load.py", line 1412, in load_dataset
[rank0]:     builder_instance.download_and_prepare(
[rank0]:   File "/sgl-workspace/nanochat/.venv/lib/python3.10/site-packages/datasets/builder.py", line 845, in download_and_prepare
[rank0]:     raise OSError(
[rank0]: OSError: Not enough disk space. Needed: Unknown size (download: 45.32 MiB, generated: 153.54 MiB, post-processed: Unknown size)
